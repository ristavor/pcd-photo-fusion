# PCD-Photo-Fusion

**PCD-Photo-Fusion** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –∏ —Å–ª–∏—è–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–∞–º–µ—Ä—ã –∏ LiDAR. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏ KITTI –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–∫—Ä–∞—à–∏–≤–∞—Ç—å –æ–±–ª–∞–∫–∞ —Ç–æ—á–µ–∫ LiDAR —Ü–≤–µ—Ç–∞–º–∏ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫–∞–º–µ—Ä—ã.

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∫–∞–º–µ—Ä—ã –∏ LiDAR**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏
- **GUI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: –£–¥–æ–±–Ω—ã–π –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ PyQt6 –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –∫–∞–º–µ—Ä—ã –∏ LiDAR
- **–†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –∏ —Ä–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫–∞–º–µ—Ä—ã
- **–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –æ–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫**: –ü—Ä–æ–µ—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ 3D –æ–±–ª–∞–∫–æ —Ç–æ—á–µ–∫ LiDAR
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Open3D –∏ OpenCV

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ main.py                      # –ì–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (GUI –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, --cli –¥–ª—è CLI —Ä–µ–∂–∏–º–∞)
‚îú‚îÄ‚îÄ main_test.py                 # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ calibration/                 # –ú–æ–¥—É–ª—å –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ board_geometry.py        # –ì–µ–æ–º–µ—Ç—Ä–∏—è –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π –¥–æ—Å–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ calib_io.py              # –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ image_corners.py         # –ü–æ–∏—Å–∫ —É–≥–ª–æ–≤ —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ pcd_roi.py               # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä ROI –≤ –æ–±–ª–∞–∫–µ —Ç–æ—á–µ–∫
‚îÇ   ‚îî‚îÄ‚îÄ viz_utils.py             # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ calibration_gui/             # –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ main_window.py           # –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ calibration_wizard.py    # –ú–∞—Å—Ç–µ—Ä –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ calibration_process.py   # –ü—Ä–æ—Ü–µ—Å—Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ colorization_window.py   # –û–∫–Ω–æ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è –æ–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ rectification_window.py  # –û–∫–Ω–æ —Ä–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ results_window.py        # –û–∫–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ processing_selection_window.py  # –í—ã–±–æ—Ä —Ç–∏–ø–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ colorizer/                   # –ú–æ–¥—É–ª—å –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è –æ–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ calibrator.py            # –ß—Ç–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö KITTI
‚îÇ   ‚îú‚îÄ‚îÄ colorizer.py             # –ê–ª–≥–æ—Ä–∏—Ç–º –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è —Ç–æ—á–µ–∫
‚îÇ   ‚îî‚îÄ‚îÄ loader.py                # –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –æ–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫
‚îÇ
‚îú‚îÄ‚îÄ rectifier/                   # –ú–æ–¥—É–ª—å —Ä–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ calib.py                 # –†–∞–±–æ—Ç–∞ —Å –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ rectifier.py             # –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ synchronizer/                # –ú–æ–¥—É–ª—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ loader.py                # –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ matcher.py               # –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ synchronizer.py          # –§–∞—Å–∞–¥ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ time_utils.py            # –£—Ç–∏–ª–∏—Ç—ã —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
‚îÇ
‚îî‚îÄ‚îÄ utils/                       # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
    ‚îú‚îÄ‚îÄ calib.py                 # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
    ‚îî‚îÄ‚îÄ constants.py             # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- OpenCV (cv2)
- NumPy
- Open3D
- PyQt6

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

–∏–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
pip install opencv-python numpy open3d PyQt6
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### –ó–∞–ø—É—Å–∫ GUI (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```bash
python src/main.py
```

–∏–ª–∏ —è–≤–Ω–æ:

```bash
python src/main.py --gui
```

GUI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–µ–∂–∏–º–∞:
1. **Start Calibration** - –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∫–∞–º–µ—Ä—ã –∏ LiDAR —Å –ø–æ–º–æ—â—å—é —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏
2. **Process Data** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (—Ä–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ)

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLI —Ä–µ–∂–∏–º–∞

```bash
python src/main.py --cli
```

CLI —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ KITTI –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –∫–∞–º–µ—Ä—ã –∏ LiDAR
- –†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –æ–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üìä –ü—Ä–æ—Ü–µ—Å—Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–í–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è:
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–æ–π
- –û–±–ª–∞–∫–æ —Ç–æ—á–µ–∫ LiDAR, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ —à–∞—Ö–º–∞—Ç–Ω—É—é –¥–æ—Å–∫—É
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –§–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –∫–∞–º–µ—Ä—ã

### 2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

- **–†–∞–∑–º–µ—Ä –ø–∞—Ç—Ç–µ—Ä–Ω–∞**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —É–≥–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 7√ó5)
- **–†–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏**: —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏ —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏ –≤ –º–µ—Ç—Ä–∞—Ö
- **–ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º**: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –æ–±–ª–∞–∫–æ —Ç–æ—á–µ–∫, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞

### 3. –ü—Ä–æ—Ü–µ—Å—Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

1. **–ü–æ–∏—Å–∫ —É–≥–ª–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥–ª–æ–≤ —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
2. **–í—ã–±–æ—Ä ROI –≤ –æ–±–ª–∞–∫–µ —Ç–æ—á–µ–∫**: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä —Ç–æ—á–µ–∫, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–µ
3. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏**: —Ä–∞—Å—á–µ—Ç –º–∞—Ç—Ä–∏—Ü—ã –ø–æ–≤–æ—Ä–æ—Ç–∞ (R) –∏ –≤–µ–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞ (T)
4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

### 4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:
- –ú–∞—Ç—Ä–∏—Ü—É –ø–æ–≤–æ—Ä–æ—Ç–∞ **R** (3√ó3)
- –í–µ–∫—Ç–æ—Ä –ø–µ—Ä–µ–Ω–æ—Å–∞ **T** (3√ó1)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ JSON

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

### Calibration

–ú–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏:

- **board_geometry.py**: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–æ—Å–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PCA
- **image_corners.py**: –ü–æ–∏—Å–∫ –∏ —É—Ç–æ—á–Ω–µ–Ω–∏–µ —É–≥–ª–æ–≤ —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏ —Å —Å—É–±–ø–∏–∫—Å–µ–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
- **pcd_roi.py**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä ROI –≤ 3D –æ–±–ª–∞–∫–µ —Ç–æ—á–µ–∫ (F+–õ–ö–ú –¥–ª—è –≤—ã–±–æ—Ä–∞, Q –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è)
- **viz_utils.py**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ü–∏–∏ LiDAR-—Ç–æ—á–µ–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

### Colorizer

–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –æ–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫:

```python
from colorizer import Colorizer

# R - –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–≤–æ—Ä–æ—Ç–∞ (3√ó3)
# T - –≤–µ–∫—Ç–æ—Ä –ø–µ—Ä–µ–Ω–æ—Å–∞ (3,)
# K - –º–∞—Ç—Ä–∏—Ü–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–∞–º–µ—Ä—ã (3√ó3)
colorizer = Colorizer(R, T, K)

# xyz - –æ–±–ª–∞–∫–æ —Ç–æ—á–µ–∫ (N√ó3)
# img - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (H√óW√ó3)
colored_pcd = colorizer.colorize(xyz, img)
```

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ë–∏–ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è —Ü–≤–µ—Ç–æ–≤
- –£—á–µ—Ç –≥–ª—É–±–∏–Ω—ã —Ç–æ—á–µ–∫
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ—á–µ–∫ –≤–Ω–µ –∫–∞–¥—Ä–∞

### Rectifier

–†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π KITTI:

```python
from rectifier import ImageRectifier

rectifier = ImageRectifier(
    calib_cam_path="path/to/calib_cam_to_cam.txt",
    cam_idx=2  # –Ω–æ–º–µ—Ä –∫–∞–º–µ—Ä—ã
)

rectified_img = rectifier.rectify(raw_img)
```

### Synchronizer

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –º–µ—Ç–∫–∞–º:

```python
from synchronizer import Synchronizer

syncer = Synchronizer(
    raw_root=Path("path/to/raw/data"),
    cam_folder="image_02"
)

# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä (–∏–Ω–¥–µ–∫—Å –∫–∞–º–µ—Ä—ã, –∏–Ω–¥–µ–∫—Å LiDAR)
matches = syncer.match_pairs()
```

## üîß –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –æ–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫

- **.bin**: –§–æ—Ä–º–∞—Ç Velodyne (KITTI) - –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª float32
- **.txt**: –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç - X Y Z [intensity/R G B]
- **.ply**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç PLY
- **.pcd**: –§–æ—Ä–º–∞—Ç Point Cloud Data

### –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã KITTI

–ü—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ KITTI:
- `calib_cam_to_cam.txt`: –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∫–∞–º–µ—Ä
- `calib_velo_to_cam.txt`: –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ LiDAR –∫ –∫–∞–º–µ—Ä–µ

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –æ–±–ª–∞–∫–∞ —Ç–æ—á–µ–∫

```python
from pathlib import Path
import cv2
from colorizer import read_velo_to_cam, Colorizer
from rectifier import ImageRectifier

# –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
R, T = read_velo_to_cam("calib_velo_to_cam.txt")

# –†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
rectifier = ImageRectifier("calib_cam_to_cam.txt", cam_idx=2)
img = cv2.imread("image.png")
img_rect = rectifier.rectify(img)

# –û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ
colorizer = Colorizer(R, T, rectifier.P_new)
colored_pcd = colorizer.colorize(lidar_points, img_rect)

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
import open3d as o3d
o3d.visualization.draw_geometries([colored_pcd])
```

### –ü—Ä–∏–º–µ—Ä 2: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞

```bash
python src/main_test.py \
    --image image.png \
    --pcd pointcloud.bin \
    --pattern 7 5 \
    --square-size 0.10
```

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ:
- **W/S**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ rvec[0]
- **A/D**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ rvec[1]
- **Q/E**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ rvec[2]
- **I/K**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ tvec[0]
- **J/L**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ tvec[1]
- **U/O**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ tvec[2]
- **C**: –æ—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ —Å –æ–∫—Ä–∞—à–µ–Ω–Ω—ã–º –æ–±–ª–∞–∫–æ–º
- **ESC**: –∑–∞–≤–µ—Ä—à–∏—Ç—å

## üé® GUI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –û–∫–Ω–æ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

1. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏
2. –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
3. –ù–∞–∂–º–∏—Ç–µ "Start Calibration"
4. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –º–∞—Å—Ç–µ—Ä–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

### –û–∫–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**–†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
- –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Ñ–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
- –£–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–∞–º–µ—Ä—ã
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –æ–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫:**
- –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –æ–±–ª–∞–∫–æ —Ç–æ—á–µ–∫
- –£–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ (R, T, K)
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –æ–∫—Ä–∞—à–µ–Ω–Ω–æ–µ –æ–±–ª–∞–∫–æ

## üî¨ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

1. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ 2D —É–≥–ª–æ–≤**: `cv2.findChessboardCorners` + `cv2.cornerSubPix`
2. **–í—ã–±–æ—Ä 3D ROI**: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä —Ç–æ—á–µ–∫ LiDAR –Ω–∞ –¥–æ—Å–∫–µ
3. **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –°–ö**: PCA –∞–Ω–∞–ª–∏–∑ —Ç–æ—á–µ–∫ ROI
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è 3D —É–≥–ª–æ–≤**: –ø—Ä–æ–µ—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≥–ª–æ–≤ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç—å –¥–æ—Å–∫–∏
5. **PnP —Ä–µ—à–µ–Ω–∏–µ**: `cv2.solvePnPRansac` –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è R –∏ T
6. **–£—Ç–æ—á–Ω–µ–Ω–∏–µ**: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ü—Ä–æ–µ–∫—Ü–∏—è —Ç–æ—á–µ–∫

–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è LiDAR ‚Üí –ö–∞–º–µ—Ä–∞:

```
P_cam = R * P_lidar + T
u = K * P_cam
[u, v] = u[:2] / u[2]
```

–ì–¥–µ:
- `R` - –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–≤–æ—Ä–æ—Ç–∞ (3√ó3)
- `T` - –≤–µ–∫—Ç–æ—Ä –ø–µ—Ä–µ–Ω–æ—Å–∞ (3,)
- `K` - –º–∞—Ç—Ä–∏—Ü–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (3√ó3)

## üìö –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- **OpenCV** (`cv2`): –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∫–∞–º–µ—Ä—ã
- **NumPy**: —á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- **Open3D**: —Ä–∞–±–æ—Ç–∞ —Å 3D –¥–∞–Ω–Ω—ã–º–∏, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- **PyQt6**: –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üêõ –û—Ç–ª–∞–¥–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ú–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–æ–¥—É–ª—å `logging` Python. –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–§—É–Ω–∫—Ü–∏–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ `calibration/viz_utils.py`:
- `reproject_and_show`: –ø—Ä–æ–µ–∫—Ü–∏—è LiDAR-—Ç–æ—á–µ–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- `draw_overlay`: –Ω–∞–ª–æ–∂–µ–Ω–∏–µ —Ç–æ—á–µ–∫ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º R –∏ T
- `make_overlay_image`: —Å–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º –≥–ª—É–±–∏–Ω—ã

## ü§ù –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
- –£–ª—É—á—à–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–∫—Ä—ã—Ç–æ–µ –ü–û –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª–µ–π.

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [KITTI Dataset](http://www.cvlibs.net/datasets/kitti/)
- [Open3D Documentation](http://www.open3d.org/docs/)
- [OpenCV Camera Calibration](https://docs.opencv.org/master/dc/dbb/tutorial_py_calibration.html)

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. **–ö–∞—á–µ—Å—Ç–≤–æ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã—Å–æ–∫–æ–∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏
2. **–í—ã–±–æ—Ä ROI**: –í—ã–±–∏—Ä–∞–π—Ç–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ (–º–∏–Ω–∏–º—É–º 4, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 20+)
3. **–†–∞–∑–º–µ—Ä –¥–æ—Å–∫–∏**: –ß–µ–º –±–æ–ª—å—à–µ –¥–æ—Å–∫–∞, —Ç–µ–º —Ç–æ—á–Ω–µ–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
4. **–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ**: –†–∞–∑–º–µ—â–∞–π—Ç–µ –¥–æ—Å–∫—É –Ω–∞ —Å—Ä–µ–¥–Ω–µ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ (2-10 –º–µ—Ç—Ä–æ–≤)
5. **–û—Å–≤–µ—â–µ–Ω–∏–µ**: –ò–∑–±–µ–≥–∞–π—Ç–µ –ø–µ—Ä–µ—Å–≤–µ—Ç–æ–≤ –∏ –≥–ª—É–±–æ–∫–∏—Ö —Ç–µ–Ω–µ–π

## üìä –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–æ–ª—å–∫–æ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–º–µ—Ä
- –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ü–µ–Ω–∞ (–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∑–∞—Ö–≤–∞—Ç –∫–∞–º–µ—Ä—ã –∏ LiDAR)
- GUI —Ç—Ä–µ–±—É–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Open3D (–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ä–µ–¥–∞—Ö)

---

**–ê–≤—Ç–æ—Ä**: ristavor  
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: pcd-photo-fusion  
**–î–∞—Ç–∞**: 2025
